# 7. 스트림 API1 - 기본
## 스트림 API란?
### 정의
- 자바8부터 추가된 기능으로, 데이터의 흐름을 추상화해서 다루는 도구이다.
- 컬렉션 또는 배열 등의 요소들을 연산 파이프라인을 통해 연속적인 형태로 처리할 수 있게 해준다.
  - 연산 파이프라인 : 여러 연산(중간 연산, 최종 연산)을 체이닝해서 데이터를 변환, 필터링, 계산하는 구조

### 특징
- 데이터 소스를 변경하지 않음
  - 스트림에서 제공하는 연산들은 원본 컬렉션(예: List, Set)을 변경하지 않고 결과만 새로 생성한다.
- 일회성(1회 소비)
  - 한 번 사용(소비)된 스트림은 다시 사용할 수 없으며, 필요하다면 새로 스트림을 생성해야 한다.
- 파이프라인 구성
  - 중간 연산(map, filter 등)들이 이어지다가, 최종 연산(forEach, collect, reduce 등)을 만나면 연산이 수행되고 종료된다.
- 지연 연산
  - 중간 연산은 필요할 때까지 실제로 동작하지 않고, 최종 연산이 실행될 때 한 번에 처리된다.
- 병렬 처리 용이
  - 스트림으로부터 병렬 스트림을 쉽게 만들 수 있어서, 멀티코어 환경에서 병렬연산을 비교적 단순한 코드로 작성할 수 있다.


## 지연 연산 정리
### 정의
- 스트림 API에서 지연 연산이란 filter, map 같은 중간 연산들은 toList와 같은 최종 연산이 호출되기 전까지 실제로 실행되지 않는다는 의미이다.
  - 즉, 중간 연산들은 결과를 바로 계산하지 않고, "무엇을 할지"에 대한 설정만 저장해 둔다.
    - 쉽게 이야기해서 람다 함수만 내부에 저장해두고, 해당 함수를 실행하지는 않는다.
  - 그리고 최종 연산(예: toList(), forEach(), findFirst() 등)이 실행되는 순간, 그때서야 중간 연산이 순차적으로 한 번에 수행된다.
    - 저장해둔 람다들을 실행한다.

### 장점
- 불필요한 연산의 생략(단축, Short-Circuiting)
  - 예를 들어 findFirst() , limit() 같은 단축 연산을 사용하면, 결과를 찾은 시점에서 더 이상 나머지 요소들을 처리할 필요가 없다.
  - 스트림이 실제로 데이터를 처리하기 직전에, "이후 연산 중에 어차피 건너뛰어도 되는 부분"을 알아내 불필요한 연산을 피할 수 있게 한다.
- 메모리 사용 효율
  - 중간 연산 결과를 매 단계마다 별도의 자료구조에 저장하지 않고, 최종 연산 때까지 필요할 때만 가져와서 처리한다.
- 파이프라인 최적화
  - 스트림은 요소를 하나씩 꺼내면서(=순차적으로) filter , map 등 연산을 묶어서 실행할 수 있다.
    - 즉, 요소 하나를 꺼냈으면 → 그 요소에 대한 filter → 통과하면 map → ... → 최종 연산까지 진행하고, 다음 요소로 넘어간다.
    - 이렇게 하면 메모리를 절약할 수 있고, 짜잘짜잘하게 중간 단계를 저장하지 않아도 되므로, 내부적으로 효율적으로 동작한다.


## 정리
- 지연 연산과 파이프라인 구조를 이해하면, 스트림 API를 사용해 더 효율적이고 간결한 코드를 작성할 수 있게 된다.
  - 필요 시 findFirst(), anyMatch(), limit() 등의 단축 연산을 적절히 활용하여 대량의 데이터를 다룰 때도 불필요한 연산을 최소화할 수 있다.
  - 또한 "코드는 선언적(무엇을 할지 작성)"이지만 내부적으로는 `효율적으로 동작`한다.
    - 따라서 비교적 간단하게 성능 향상을 얻을 수 있다.
- 스트림의 지연 연산 개념과 단축 평가 방식을 잘 이해해두면, 실무에서 대량의 컬렉션/데이터를 효율적으로 다룰 때 도움이 된다.
- 정리하면, `스트림 API의 핵심은 "어떤 연산을 할지" 파이프라인을 정의해놓고, 최종 연산이 실행될 때 한 번에 처리`한다는 점이다.